# 测试指南

## 准备工作

### 1. 生成图标文件

在测试之前，需要先生成图标文件：

1. 在浏览器中打开 `scripts/generate-icons.html`
2. 点击"生成图标"按钮预览
3. 点击"下载所有图标"按钮下载PNG文件
4. 将下载的4个图标文件（icon16.png, icon32.png, icon48.png, icon128.png）移动到 `assets/icons/` 目录

### 2. 准备WebDAV服务器

你需要一个WebDAV服务器来测试同步功能。可以使用以下服务：

- **Nextcloud**（推荐）：https://nextcloud.com/
- **ownCloud**：https://owncloud.com/
- **坚果云**：https://www.jianguoyun.com/（国内用户）
- **其他WebDAV服务**

记录以下信息：
- WebDAV服务器地址（如：`https://your-domain.com/remote.php/dav/files/username/`）
- 用户名
- 密码
- 同步路径（默认：`/bookmarks/`）

## 安装插件

### Chrome浏览器

1. 打开Chrome浏览器
2. 访问 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目根目录（`cloud_bookmark`文件夹）
6. 确认插件已加载（应该能看到"云端书签"插件）

### Firefox浏览器

1. 打开Firefox浏览器
2. 访问 `about:debugging`
3. 点击左侧的"此Firefox"
4. 点击"临时载入附加组件"
5. 选择项目根目录下的 `manifest.json` 文件
6. 确认插件已加载

## 功能测试清单

### 基础功能测试

#### 1. 插件安装和初始化
- [ ] 插件图标显示在浏览器工具栏
- [ ] 点击图标能打开弹出窗口
- [ ] 右键菜单中有"添加到云端书签"选项
- [ ] 快捷键 `Ctrl+Shift+B`（Mac: `Command+Shift+B`）可以触发添加书签

#### 2. WebDAV配置
- [ ] 点击插件图标 → 设置，能打开设置页面
- [ ] 填写WebDAV服务器信息：
  - 服务器地址
  - 用户名
  - 密码
  - 同步路径
  - 同步间隔
- [ ] 点击"测试连接"能成功连接
- [ ] 点击"保存配置"能保存配置

#### 3. 添加书签

**方式一：通过弹出窗口**
- [ ] 点击插件图标
- [ ] 点击"添加当前页面"按钮
- [ ] 能打开添加书签页面，自动填充当前页面信息

**方式二：通过右键菜单**
- [ ] 在任意网页右键
- [ ] 选择"添加到云端书签"
- [ ] 能打开添加书签页面，自动填充页面信息

**方式三：通过快捷键**
- [ ] 在任意网页按 `Ctrl+Shift+B`
- [ ] 能打开添加书签页面

**方式四：在书签管理页面**
- [ ] 打开书签管理页面
- [ ] 点击"+"按钮
- [ ] 填写书签信息并保存

**测试添加书签表单：**
- [ ] 标题字段（必填）
- [ ] URL字段（必填，验证URL格式）
- [ ] 描述字段（可选）
- [ ] 备注/笔记字段（可选，多行文本）
- [ ] 标签字段（可选，逗号分隔）
- [ ] 文件夹选择（可选）
- [ ] 收藏复选框
- [ ] 保存按钮能保存书签
- [ ] 保存后自动同步到云端

#### 4. 查看书签

- [ ] 打开书签管理页面能看到所有书签
- [ ] 书签以卡片形式展示（网格视图）
- [ ] 书签显示：标题、URL、描述、备注、标签、收藏状态
- [ ] 点击书签卡片能打开网站（新标签页）
- [ ] 切换视图模式（网格/列表）

#### 5. 搜索和筛选

**搜索功能：**
- [ ] 在搜索框输入关键词能搜索书签
- [ ] 搜索支持标题、URL、描述、备注、标签
- [ ] 搜索结果实时更新

**筛选功能：**
- [ ] 点击"全部书签"显示所有书签
- [ ] 点击"收藏"只显示收藏的书签
- [ ] 点击"最近添加"显示最近添加的书签
- [ ] 点击文件夹筛选该文件夹的书签
- [ ] 点击标签筛选该标签的书签

**排序功能：**
- [ ] 按创建时间排序（最新/最旧）
- [ ] 按标题排序（A-Z/Z-A）
- [ ] 按收藏状态排序

#### 6. 编辑书签

- [ ] 点击书签卡片的编辑按钮
- [ ] 能打开编辑表单，预填充现有数据
- [ ] 修改信息后保存
- [ ] 保存后自动同步到云端

#### 7. 删除书签

- [ ] 点击书签卡片的删除按钮
- [ ] 弹出确认对话框
- [ ] 确认后删除书签
- [ ] 删除后自动同步到云端

#### 8. 收藏功能

- [ ] 点击书签卡片的星标图标
- [ ] 能切换收藏状态
- [ ] 收藏的书签有特殊标识
- [ ] 在"收藏"筛选下能看到收藏的书签

#### 9. 文件夹管理

- [ ] 添加书签时可以选择文件夹
- [ ] 可以创建新文件夹（输入新文件夹名）
- [ ] 侧边栏显示所有文件夹
- [ ] 点击文件夹能筛选该文件夹的书签

#### 10. 标签管理

- [ ] 添加书签时可以添加标签（逗号分隔）
- [ ] 侧边栏显示所有标签
- [ ] 点击标签能筛选该标签的书签
- [ ] 书签卡片显示标签

### 同步功能测试

#### 1. 云端到本地同步

- [ ] 配置WebDAV后，点击"立即同步"
- [ ] 能成功从云端读取书签
- [ ] 同步状态显示"成功"
- [ ] 同步后本地书签更新

#### 2. 本地到云端同步

- [ ] 添加新书签后，自动同步到云端
- [ ] 修改书签后，自动同步到云端
- [ ] 删除书签后，自动同步到云端
- [ ] 同步状态显示"同步中"然后"成功"

#### 3. 定时同步

- [ ] 设置同步间隔（如1分钟）
- [ ] 等待定时同步触发
- [ ] 检查同步状态是否更新

#### 4. 离线模式

- [ ] 断开网络连接
- [ ] 能正常查看本地书签
- [ ] 能正常添加/编辑/删除书签（本地操作）
- [ ] 恢复网络后，本地变更自动同步到云端

### 导入导出功能测试

#### 1. 导出为JSON

- [ ] 在设置页面点击"导出JSON"
- [ ] 能下载JSON文件
- [ ] JSON文件包含所有书签数据
- [ ] 在书签管理页面点击导出按钮 → 导出JSON，也能下载

#### 2. 导出为HTML

- [ ] 在设置页面点击"导出HTML"
- [ ] 能下载HTML文件
- [ ] HTML文件格式正确
- [ ] 可以将HTML文件导入到浏览器书签管理器

#### 3. 导入JSON文件

- [ ] 在设置页面点击"导入书签"
- [ ] 选择JSON文件
- [ ] 能成功导入书签
- [ ] 导入后自动合并到现有书签
- [ ] 导入后自动同步到云端

#### 4. 导入HTML文件

- [ ] 在设置页面点击"导入书签"
- [ ] 选择HTML文件（浏览器导出的书签文件）
- [ ] 能成功解析并导入书签
- [ ] 能正确解析文件夹结构
- [ ] 导入后自动同步到云端

#### 5. 从浏览器导入

- [ ] 在设置页面点击"从浏览器导入"
- [ ] 确认导入对话框
- [ ] 能成功导入浏览器书签栏的所有书签
- [ ] 能正确保留文件夹结构
- [ ] 导入后自动同步到云端

### 错误处理测试

#### 1. WebDAV连接错误

- [ ] 输入错误的服务器地址，测试连接应显示错误
- [ ] 输入错误的用户名/密码，测试连接应显示认证失败
- [ ] 网络断开时，同步应显示错误状态

#### 2. 数据错误

- [ ] 导入格式错误的JSON文件应显示错误提示
- [ ] 导入格式错误的HTML文件应显示错误提示

#### 3. 权限错误

- [ ] 如果没有bookmarks权限，导入浏览器书签应显示错误

## 调试方法

### Chrome浏览器

1. **查看后台脚本日志**：
   - 访问 `chrome://extensions/`
   - 找到"云端书签"插件
   - 点击"service worker"链接
   - 查看控制台日志

2. **查看弹出窗口日志**：
   - 右键点击插件图标
   - 选择"检查弹出内容"
   - 查看控制台日志

3. **查看设置页面日志**：
   - 打开设置页面
   - 按F12打开开发者工具
   - 查看控制台日志

4. **查看书签管理页面日志**：
   - 打开书签管理页面
   - 按F12打开开发者工具
   - 查看控制台日志

### Firefox浏览器

1. **查看后台脚本日志**：
   - 访问 `about:debugging`
   - 找到"云端书签"插件
   - 点击"检查"按钮
   - 查看控制台日志

2. **查看弹出窗口日志**：
   - 右键点击插件图标
   - 选择"检查"
   - 查看控制台日志

3. **查看设置页面和书签管理页面日志**：
   - 打开页面
   - 按F12打开开发者工具
   - 查看控制台日志

## 常见问题排查

### 1. 插件无法加载

- 检查manifest.json格式是否正确
- 检查是否有语法错误
- 查看浏览器控制台的错误信息

### 2. 图标不显示

- 确认图标文件已放在 `assets/icons/` 目录
- 确认图标文件名正确（icon16.png, icon32.png, icon48.png, icon128.png）
- 重新加载插件

### 3. WebDAV连接失败

- 检查服务器地址格式是否正确（应以 `/` 结尾）
- 检查用户名和密码是否正确
- 检查网络连接
- 检查WebDAV服务器是否支持CORS（可能需要配置）

### 4. 同步失败

- 检查WebDAV配置是否正确
- 检查网络连接
- 查看后台脚本的控制台日志
- 检查WebDAV服务器权限

### 5. 书签无法添加

- 检查URL格式是否正确
- 查看控制台是否有错误
- 检查本地存储权限

### 6. 导入导出失败

- 检查文件格式是否正确
- 查看控制台错误信息
- 检查文件大小是否过大

## 性能测试

### 大量数据测试

1. 导入1000+书签
2. 测试搜索性能
3. 测试列表渲染性能
4. 测试同步性能

### 网络异常测试

1. 模拟网络延迟
2. 模拟网络中断
3. 测试重试机制

## 测试完成检查

完成所有测试后，确认：

- [ ] 所有核心功能正常工作
- [ ] 没有明显的错误和警告
- [ ] 用户体验流畅
- [ ] 同步功能稳定
- [ ] 错误处理完善
- [ ] 性能满足要求

## 报告问题

如果发现bug，请记录：

1. 浏览器类型和版本
2. 操作系统
3. 复现步骤
4. 预期行为
5. 实际行为
6. 控制台错误信息
7. 截图（如适用）

